import{A as B,a as ct,b as re,c as dt,d as pt,e as Ce,f as mt,g as ut,h as ht,i as ft,j as gt,k as _t,l as Y,m as U,n as yt,r as vt,s as wt}from"./chunk-SVBGSICU.js";import{a as xe,b as nt,c as it,d as I,f as ot,g as ie,h as oe,i as rt,j as at,l as st,n as Me,o as lt}from"./chunk-JTN6Z4EA.js";import{A as w,B as ge,Ba as l,C as He,Ca as c,D as Le,Da as N,Ea as S,G as m,H as u,I as Q,Ia as h,J as Ve,Ja as d,L as J,M as We,N as W,O as j,P as _e,Qa as qe,R as z,Ra as f,S as je,Sa as we,T as ye,Ta as Xe,U as ze,Ua as ne,V as ee,Va as be,W as Ue,Wa as Ke,X as ve,Xa as Qe,Y as Be,Z as $e,Za as Je,aa as G,ba as x,bb as et,ca as Z,d as Ne,ea as te,eb as tt,g as Fe,ha as Ge,ka as O,la as T,qa as M,u as V,ua as Ze,va as Ye,w as v,x as D,xa as b,y as $,z as y}from"./chunk-2NPV4RVZ.js";import{a as fe,b as ke}from"./chunk-C6Q5SG76.js";var Ie=class extends it{supportsDOMEvents=!0},Ee=class o extends Ie{static makeCurrent(){nt(new o)}onAndCancel(t,e,n,i){return t.addEventListener(e,n,i),()=>{t.removeEventListener(e,n,i)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.remove()}createElement(t,e){return e=e||this.getDefaultDocument(),e.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return e==="window"?window:e==="document"?t:e==="body"?t.body:null}getBaseHref(t){let e=Ft();return e==null?null:Ht(e)}resetBaseElement(){q=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return ot(document.cookie,t)}},q=null;function Ft(){return q=q||document.querySelector("base"),q?q.getAttribute("href"):null}function Ht(o){return new URL(o,document.baseURI).pathname}var Lt=(()=>{class o{build(){return new XMLHttpRequest}static \u0275fac=function(n){return new(n||o)};static \u0275prov=v({token:o,factory:o.\u0275fac})}return o})(),De=new $(""),St=(()=>{class o{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,n){this._zone=n,e.forEach(i=>{i.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,n,i,r){return this._findPluginFor(n).addEventListener(e,n,i,r)}getZone(){return this._zone}_findPluginFor(e){let n=this._eventNameToPlugin.get(e);if(n)return n;if(n=this._plugins.find(r=>r.supports(e)),!n)throw new V(5101,!1);return this._eventNameToPlugin.set(e,n),n}static \u0275fac=function(n){return new(n||o)(y(De),y(j))};static \u0275prov=v({token:o,factory:o.\u0275fac})}return o})(),se=class{_doc;constructor(t){this._doc=t}manager},ae="ng-app-id";function bt(o){for(let t of o)t.remove()}function xt(o,t){let e=t.createElement("style");return e.textContent=o,e}function Vt(o,t,e,n){let i=o.head?.querySelectorAll(`style[${ae}="${t}"],link[${ae}="${t}"]`);if(i)for(let r of i)r.removeAttribute(ae),r instanceof HTMLLinkElement?n.set(r.href.slice(r.href.lastIndexOf("/")+1),{usage:0,elements:[r]}):r.textContent&&e.set(r.textContent,{usage:0,elements:[r]})}function Te(o,t){let e=t.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",o),e}var It=(()=>{class o{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(e,n,i,r={}){this.doc=e,this.appId=n,this.nonce=i,this.isServer=Me(r),Vt(e,n,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,n){for(let i of e)this.addUsage(i,this.inline,xt);n?.forEach(i=>this.addUsage(i,this.external,Te))}removeStyles(e,n){for(let i of e)this.removeUsage(i,this.inline);n?.forEach(i=>this.removeUsage(i,this.external))}addUsage(e,n,i){let r=n.get(e);r?r.usage++:n.set(e,{usage:1,elements:[...this.hosts].map(a=>this.addElement(a,i(e,this.doc)))})}removeUsage(e,n){let i=n.get(e);i&&(i.usage--,i.usage<=0&&(bt(i.elements),n.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])bt(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[n,{elements:i}]of this.inline)i.push(this.addElement(e,xt(n,this.doc)));for(let[n,{elements:i}]of this.external)i.push(this.addElement(e,Te(n,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,n){return this.nonce&&n.setAttribute("nonce",this.nonce),this.isServer&&n.setAttribute(ae,this.appId),e.appendChild(n)}static \u0275fac=function(n){return new(n||o)(y(I),y(ye),y(ve,8),y(ee))};static \u0275prov=v({token:o,factory:o.\u0275fac})}return o})(),Se={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Pe=/%COMP%/g;var Et="%COMP%",Wt=`_nghost-${Et}`,jt=`_ngcontent-${Et}`,zt=!0,Ut=new $("",{providedIn:"root",factory:()=>zt});function Bt(o){return jt.replace(Pe,o)}function $t(o){return Wt.replace(Pe,o)}function Dt(o,t){return t.map(e=>e.replace(Pe,o))}var le=(()=>{class o{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,n,i,r,a,s,p,g=null,_=null){this.eventManager=e,this.sharedStylesHost=n,this.appId=i,this.removeStylesOnCompDestroy=r,this.doc=a,this.platformId=s,this.ngZone=p,this.nonce=g,this.tracingService=_,this.platformIsServer=Me(s),this.defaultRenderer=new X(e,a,p,this.platformIsServer,this.tracingService)}createRenderer(e,n){if(!e||!n)return this.defaultRenderer;this.platformIsServer&&n.encapsulation===G.ShadowDom&&(n=ke(fe({},n),{encapsulation:G.Emulated}));let i=this.getOrCreateRenderer(e,n);return i instanceof ce?i.applyToHost(e):i instanceof K&&i.applyStyles(),i}getOrCreateRenderer(e,n){let i=this.rendererByCompId,r=i.get(n.id);if(!r){let a=this.doc,s=this.ngZone,p=this.eventManager,g=this.sharedStylesHost,_=this.removeStylesOnCompDestroy,k=this.platformIsServer,P=this.tracingService;switch(n.encapsulation){case G.Emulated:r=new ce(p,g,n,this.appId,_,a,s,k,P);break;case G.ShadowDom:return new Re(p,g,e,n,a,s,this.nonce,k,P);default:r=new K(p,g,n,_,a,s,k,P);break}i.set(n.id,r)}return r}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(n){return new(n||o)(y(St),y(It),y(ye),y(Ut),y(I),y(ee),y(j),y(ve),y(Be,8))};static \u0275prov=v({token:o,factory:o.\u0275fac})}return o})(),X=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,e,n,i,r){this.eventManager=t,this.doc=e,this.ngZone=n,this.platformIsServer=i,this.tracingService=r}destroy(){}destroyNode=null;createElement(t,e){return e?this.doc.createElementNS(Se[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(Mt(t)?t.content:t).appendChild(e)}insertBefore(t,e,n){t&&(Mt(t)?t.content:t).insertBefore(e,n)}removeChild(t,e){e.remove()}selectRootElement(t,e){let n=typeof t=="string"?this.doc.querySelector(t):t;if(!n)throw new V(-5104,!1);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,i){if(i){e=i+":"+e;let r=Se[i];r?t.setAttributeNS(r,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){let i=Se[n];i?t.removeAttributeNS(i,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,i){i&(Z.DashCase|Z.Important)?t.style.setProperty(e,n,i&Z.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&Z.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t!=null&&(t[e]=n)}setValue(t,e){t.nodeValue=e}listen(t,e,n,i){if(typeof t=="string"&&(t=xe().getGlobalEventTarget(this.doc,t),!t))throw new V(5102,!1);let r=this.decoratePreventDefault(n);return this.tracingService?.wrapEventListener&&(r=this.tracingService.wrapEventListener(t,e,r)),this.eventManager.addEventListener(t,e,r,i)}decoratePreventDefault(t){return e=>{if(e==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))===!1&&e.preventDefault()}}};function Mt(o){return o.tagName==="TEMPLATE"&&o.content!==void 0}var Re=class extends X{sharedStylesHost;hostEl;shadowRoot;constructor(t,e,n,i,r,a,s,p,g){super(t,r,a,p,g),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let _=i.styles;_=Dt(i.id,_);for(let P of _){let L=document.createElement("style");s&&L.setAttribute("nonce",s),L.textContent=P,this.shadowRoot.appendChild(L)}let k=i.getExternalStyles?.();if(k)for(let P of k){let L=Te(P,r);s&&L.setAttribute("nonce",s),this.shadowRoot.appendChild(L)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(null,e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},K=class extends X{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,e,n,i,r,a,s,p,g){super(t,r,a,s,p),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=i;let _=n.styles;this.styles=g?Dt(g,_):_,this.styleUrls=n.getExternalStyles?.(g)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},ce=class extends K{contentAttr;hostAttr;constructor(t,e,n,i,r,a,s,p,g){let _=i+"-"+n.id;super(t,e,n,r,a,s,p,g,_),this.contentAttr=Bt(_),this.hostAttr=$t(_)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){let n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}},Gt=(()=>{class o extends se{constructor(e){super(e)}supports(e){return!0}addEventListener(e,n,i,r){return e.addEventListener(n,i,r),()=>this.removeEventListener(e,n,i,r)}removeEventListener(e,n,i,r){return e.removeEventListener(n,i,r)}static \u0275fac=function(n){return new(n||o)(y(I))};static \u0275prov=v({token:o,factory:o.\u0275fac})}return o})(),Ct=["alt","control","meta","shift"],Zt={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Yt={alt:o=>o.altKey,control:o=>o.ctrlKey,meta:o=>o.metaKey,shift:o=>o.shiftKey},qt=(()=>{class o extends se{constructor(e){super(e)}supports(e){return o.parseEventName(e)!=null}addEventListener(e,n,i,r){let a=o.parseEventName(n),s=o.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>xe().onAndCancel(e,a.domEventName,s,r))}static parseEventName(e){let n=e.toLowerCase().split("."),i=n.shift();if(n.length===0||!(i==="keydown"||i==="keyup"))return null;let r=o._normalizeKey(n.pop()),a="",s=n.indexOf("code");if(s>-1&&(n.splice(s,1),a="code."),Ct.forEach(g=>{let _=n.indexOf(g);_>-1&&(n.splice(_,1),a+=g+".")}),a+=r,n.length!=0||r.length===0)return null;let p={};return p.domEventName=i,p.fullKey=a,p}static matchEventFullKeyCode(e,n){let i=Zt[e.key]||e.key,r="";return n.indexOf("code.")>-1&&(i=e.code,r="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Ct.forEach(a=>{if(a!==i){let s=Yt[a];s(e)&&(r+=a+".")}}),r+=i,r===n)}static eventCallback(e,n,i){return r=>{o.matchEventFullKeyCode(r,e)&&i.runGuarded(()=>n(r))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(n){return new(n||o)(y(I))};static \u0275prov=v({token:o,factory:o.\u0275fac})}return o})();function Tt(o,t){return et(fe({rootComponent:o},Xt(t)))}function Xt(o){return{appProviders:[...tn,...o?.providers??[]],platformProviders:en}}function Kt(){Ee.makeCurrent()}function Qt(){return new _e}function Jt(){return je(document),document}var en=[{provide:ee,useValue:st},{provide:ze,useValue:Kt,multi:!0},{provide:I,useFactory:Jt,deps:[]}];var tn=[{provide:Le,useValue:"root"},{provide:_e,useFactory:Qt,deps:[]},{provide:De,useClass:Gt,multi:!0,deps:[I]},{provide:De,useClass:qt,multi:!0,deps:[I]},le,It,St,{provide:te,useExisting:le},{provide:lt,useClass:Lt,deps:[]},[]];var nn="@",on=(()=>{class o{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=w(J);loadingSchedulerFn=w(rn,{optional:!0});_engine;constructor(e,n,i,r,a){this.doc=e,this.delegate=n,this.zone=i,this.animationType=r,this.moduleImpl=a}ngOnDestroy(){this._engine?.flush()}loadImpl(){let e=()=>this.moduleImpl??import("./chunk-RUGDXGD3.js").then(i=>i),n;return this.loadingSchedulerFn?n=this.loadingSchedulerFn(e):n=e(),n.catch(i=>{throw new V(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:r})=>{this._engine=i(this.animationType,this.doc);let a=new r(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(e,n){let i=this.delegate.createRenderer(e,n);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let r=new Oe(i);return n?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let s=a.createRenderer(e,n);r.use(s),this.scheduler??=this.injector.get(We,null,{optional:!0}),this.scheduler?.notify(10)}).catch(a=>{r.use(i)}),r}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(e){this._engine?.flush(),this.delegate.componentReplaced?.(e)}static \u0275fac=function(n){Ge()};static \u0275prov=v({token:o,factory:o.\u0275fac})}return o})(),Oe=class{delegate;replay=[];\u0275type=1;constructor(t){this.delegate=t}use(t){if(this.delegate=t,this.replay!==null){for(let e of this.replay)e(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,e){this.delegate.appendChild(t,e)}insertBefore(t,e,n,i){this.delegate.insertBefore(t,e,n,i)}removeChild(t,e,n){this.delegate.removeChild(t,e,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,i){this.delegate.setAttribute(t,e,n,i)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,i){this.delegate.setStyle(t,e,n,i)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){this.shouldReplay(e)&&this.replay.push(i=>i.setProperty(t,e,n)),this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n,i){return this.shouldReplay(e)&&this.replay.push(r=>r.listen(t,e,n,i)),this.delegate.listen(t,e,n,i)}shouldReplay(t){return this.replay!==null&&t.startsWith(nn)}},rn=new $("");function Rt(o="animations"){return $e("NgAsyncAnimations"),ge([{provide:te,useFactory:(t,e,n)=>new on(t,e,n,o),deps:[I,le,j]},{provide:Ue,useValue:o==="noop"?"NoopAnimations":"BrowserAnimations"}])}var F=class o{static csvConf={useKeysAsHeaders:!0,quoteCharacter:"",fieldSeparator:","};async resultsToCsv(t,e){let n=this._parceResults(t,e);import("./chunk-4UTBWCBA.js").then(i=>{let r=i.mkConfig(o.csvConf),a=i.generateCsv(r)(n);i.download(r)(a)})}_parceResults(t,e){if(t.MWDs.length!==t.soilPortions.length||t.soilPortions.length!==t.tamizDiameterProm.length)throw new Error("Resultados con mal formato: intente mas tarde");let n=[];for(let i=0;i<Array.from(e.keys()).length;i++){let r={soilWeight:e.get(i).soilWeight.toFixed(6),tamizDiameter:e.get(i).tamizDiameter.toFixed(6),tamizDiam:t.tamizDiameterProm[i]?.toFixed(6)??void 0,soilPortions:t.soilPortions[i]?.toFixed(6)??void 0,MWDs:t.MWDs[i]?.toFixed(6)??void 0};n.push(r)}return n[0].totalSoil=t.totalSoilWeight.toFixed(6),n[0].MWDTotal=t.MWDTotal,n}static \u0275fac=function(e){return new(e||o)};static \u0275prov=v({token:o,factory:o.\u0275fac,providedIn:"root"})};var A=class o{static getEmptyResults(){return{MWDTotal:-1,totalSoilWeight:-1,MWDs:[],soilPortions:[],tamizDiameterProm:[]}}static cleanResults(t){t=o.getEmptyResults()}static itHasProcessedData(t){return t.MWDTotal!==-1||t.totalSoilWeight!==-1||t.MWDs.length<=0||t.soilPortions.length<=0||t.tamizDiameterProm.length<=0}static areEquals(t,e){if(t.totalSoilWeight!==e.totalSoilWeight)return!1;for(let i=0;i<t.tamizDiameterProm.length;i++){let r=Number(t.tamizDiameterProm[i].toFixed(3)),a=e.tamizDiameterProm[i];if(r!==a)return!1}for(let i=0;i<t.soilPortions.length;i++){let r=t.soilPortions[i],a=e.soilPortions[i];if(r!==a)return!1}for(let i=0;i<t.MWDs.length;i++){let r=t.MWDs[i].toFixed(7),a=e.MWDs[i].toFixed(7);if(r!==a)throw new Error("Value expected and got different")}if(Number(t.MWDTotal.toFixed(2))!==e.MWDTotal)throw new Error("Value expected and got different");return!1}};var de=class o{_samplesRows;_results=A.getEmptyResults();static precision=9;setData(t){this._samplesRows=t,this._adustPrecisionSample(),A.itHasProcessedData(this._results)&&A.cleanResults(this._results)}calcTotalSoilWeight(){if(this._results.totalSoilWeight!=-1)return this._results.totalSoilWeight;let t=0;return this._getSoilWeights().forEach(n=>{t=t+n}),this._results.totalSoilWeight=t,this._results.totalSoilWeight}calcTamizDiameterProm(){if(this._results.tamizDiameterProm.length!==0)return this._results.tamizDiameterProm;let t=[],e=this._getTamizDiameters();for(let n=0;n<e.length-1;n++){let i=e[n],r=e[n+1],s=(i+r)/2;t.push(s)}return this._results.tamizDiameterProm=t,this._results.tamizDiameterProm}calcSoilPortions(){if(this._results.soilPortions.length!==0)return this._results.soilPortions;let t=this._getSoilWeights();t.shift();let e=this.calcTotalSoilWeight(),n=t.map(i=>{let r=i/e;return this._adustPrecision(Number(r.toFixed(9)))});return this._results.soilPortions=n,this._results.soilPortions}calcMWDs(){if(this._results.MWDs.length!==0)return this._results.MWDs;let t=this.calcTamizDiameterProm(),e=this.calcSoilPortions();if(t.length!=e.length)throw new Error("unexpected: soilWeights.length != soilPortions.length");let n=[];for(let i=0;i<t.length;i++){let r=t[i],a=e[i],s=r*a,p=this._adustPrecision(s);n.push(p)}return this._results.MWDs=n,this._results.MWDs}calcMWDTotal(){if(this._results.MWDTotal!=-1)return this._results.MWDTotal;let t=this.calcMWDs(),e=0;for(let n=0;n<t.length;n++)e=e+t[n];return this._results.MWDTotal=e,this._results.MWDTotal}_getTamizDiameters(){return Array.from(this._samplesRows.values()).map(e=>e.tamizDiameter)}_getSoilWeights(){return Array.from(this._samplesRows.values()).map(e=>e.soilWeight)}_adustPrecision(t){return Number(t.toFixed(o.precision))}_adustPrecisionSample(){this._samplesRows.values()}getResults(){let t=A.getEmptyResults();return Object.assign(t,this._results),t}};var R=class o{resolveSamples(t){let e=new de;return e.setData(t),e.calcTotalSoilWeight(),e.calcTamizDiameterProm(),e.calcSoilPortions(),e.calcMWDs(),e.calcMWDTotal(),e.getResults()}async parseFileToSamples(t){return new Promise(async(n,i)=>{let r=await import("./chunk-LXHA67IG.js");new r.Papa().parse(t,{complete:(s,p)=>{let g=this._parseDataFileToSample(s.data);n(g)},error:s=>{i(s)}})})}_parseDataFileToSample(t){let n=t.map(r=>r.slice(0,2));isNaN(Number(n[0][0]))&&(console.log("has header"),n.shift());let i=new Map;for(let r=0;r<n.length-1;r++){let a=n[r],s=Number(a[0]);if(isNaN(s))throw new Error("bad format in: '"+a[0]+"'");let p=Number(a[1]);if(isNaN(p))throw new Error("bad format in: '"+a[1]+"'");i.set(r,{soilWeight:s,tamizDiameter:p})}return i}static \u0275fac=function(e){return new(e||o)};static \u0275prov=v({token:o,factory:o.\u0275fac})};var pe=class o{getOutputDriver(){return new F}getInputDriver(){return new R}static \u0275fac=function(e){return new(e||o)};static \u0275mod=T({type:o});static \u0275inj=D({providers:[F,R]})};var Pt={providers:[Je(),He(pe),Rt("noop")]};var H=class o{_allSamples$=new Ne([this.getExample()]);addSamplesRecord(t){t.createdAt===void 0&&(t.createdAt=new Date),!this._doesSampleExist(t)&&this._allSamples$.next([...this._allSamples$.value,t])}_doesSampleExist(t){let e=t.result;return e===0||e===void 0?!0:this._allSamples$.value.some(i=>i.result===e)}getSamplesByItem(t){return this._allSamples$.value[t].sample}observeAllSamplesRecords(){return this._allSamples$.asObservable()}cleanAll(){this._allSamples$.next([this.getExample()])}cleanOne(t){let e=this._allSamples$.value;if(t<0||t>=e.length)throw new Error("Index out of bounds");e.splice(t,1),this._allSamples$.next(e)}getExample(){return{sample:new Map([[0,{tamizDiameter:8,soilWeight:0}],[1,{tamizDiameter:4,soilWeight:3.4}],[2,{tamizDiameter:2,soilWeight:21.26}],[3,{tamizDiameter:1,soilWeight:34.73}],[4,{tamizDiameter:.5,soilWeight:35.69}],[5,{tamizDiameter:.25,soilWeight:31.31}],[6,{tamizDiameter:.053,soilWeight:38.26}],[7,{tamizDiameter:0,soilWeight:25.37}]]),result:.953859829,createdAt:new Date("2025-04-07T18:50:00-06:00")}}static \u0275fac=function(e){return new(e||o)};static \u0275prov=v({token:o,factory:o.\u0275fac,providedIn:"root"})};var Ot=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=T({type:o});static \u0275inj=D({})}return o})();var At=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=T({type:o});static \u0275inj=D({imports:[Y,Ot,vt]})}return o})();var Ae=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=T({type:o});static \u0275inj=D({imports:[Y,Y]})}return o})();function un(o,t){if(o&1){let e=S();Q(),l(0,"svg",16),h("click",function(i){m(e);let r=d().index;return d(3).onClickCleanOne(r),u(i.stopPropagation())}),N(1,"path",17),c()}}function hn(o,t){if(o&1){let e=S();l(0,"div",13)(1,"div",14),h("click",function(){let i=m(e).index,r=d(3);return u(r.onRecordClick(i))}),l(2,"div",11),f(3),be(4,"date"),c(),l(5,"div"),f(6),M(7,un,2,0,"svg",15),c(),l(8,"div"),f(9),c()()()}if(o&2){let e=t.$implicit,n=t.index;x(3),we(Qe(4,4,e.createdAt,"short")),x(3),Xe(" ",n===0?"Ejemplo":n," "),x(),b("ngIf",n!==0),x(2),we(e.result)}}function fn(o,t){if(o&1&&(l(0,"div",9)(1,"div",10)(2,"div",11),f(3,"Agregado"),c(),l(4,"div"),f(5,"Nombre"),c(),l(6,"div"),f(7,"Resultado"),c()(),M(8,hn,10,7,"div",12),c()),o&2){let e=d().ngIf;x(8),b("ngForOf",e)}}function gn(o,t){if(o&1){let e=S();l(0,"div",1)(1,"div",2)(2,"button",3),h("click",function(){m(e);let i=d();return u(i.onClickBackFromHistory())}),Q(),l(3,"svg",4),N(4,"path",5),c()(),Ve(),l(5,"h4"),f(6,"Historial"),c()(),M(7,fn,9,1,"div",6),l(8,"div",7)(9,"button",8),h("click",function(){m(e);let i=d();return u(i.onClickBackFromHistory())}),f(10,"Regresar"),c()()()}if(o&2){let e=t.ngIf;x(7),b("ngIf",e.length>0)}}var me=class o{recordClick=new W;backFromHistory=new W;_srv=w(H);panelOpenState=z(!1);history$=this._srv.observeAllSamplesRecords().pipe(Fe(t=>t.map(e=>e)));onClickClean(){this._srv.cleanAll()}onClickCleanOne(t){this._srv.cleanOne(t)}onRecordClick(t){let e=this._srv.getSamplesByItem(t);this.recordClick.emit(e),this.backFromHistory.emit()}onClickBackFromHistory(){this.backFromHistory.emit()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=O({type:o,selectors:[["mwd-history"]],outputs:{recordClick:"recordClick",backFromHistory:"backFromHistory"},decls:2,vars:3,consts:[["class","history-container",4,"ngIf"],[1,"history-container"],[1,"history-header"],["mat-button","",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","16","height","26","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-chevron-left"],["fill-rule","evenodd","d","M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"],["class","history-list",4,"ngIf"],[1,"btn-group"],["mat-raised-button","",3,"click"],[1,"history-list"],[1,"history-row","history-itemHeader"],[2,"min-width","140px"],["class","history-row-container",4,"ngFor","ngForOf"],[1,"history-row-container"],[1,"history-row","history-item",3,"click"],["style","margin-left: 5px;","xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","class","bi bi-trash3","viewBox","0 0 16 16",3,"click",4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","width","16","height","16","fill","currentColor","viewBox","0 0 16 16",1,"bi","bi-trash3",2,"margin-left","5px",3,"click"],["d","M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47M8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"]],template:function(e,n){e&1&&(M(0,gn,11,1,"div",0),be(1,"async")),e&2&&b("ngIf",Ke(1,1,n.history$))},dependencies:[B,ie,oe,U,rt,at,At,yt,Ae],styles:[".history-container[_ngcontent-%COMP%]{padding:1rem;background-color:#f9f9f9;max-width:500px;margin:0 auto;margin-bottom:1rem}@media (width >= 800px){.history-container[_ngcontent-%COMP%]{min-width:400px}}.history-container[_ngcontent-%COMP%]   .history-header[_ngcontent-%COMP%]{display:flex;justify-items:center;height:50px}.history-container[_ngcontent-%COMP%]   .history-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:min-content}.history-container[_ngcontent-%COMP%]   .history-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;color:#333;height:min-content}.history-container[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]{gap:.5rem}.history-container[_ngcontent-%COMP%]   .history-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0;max-height:300px;overflow-y:auto;border:1px solid #ccc;border-radius:8px;background-color:#fff}.history-container[_ngcontent-%COMP%]   .history-list[_ngcontent-%COMP%]   .history-row[_ngcontent-%COMP%]{padding:5px;display:flex;justify-content:space-between}.history-container[_ngcontent-%COMP%]   .history-list[_ngcontent-%COMP%]   .history-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:1}.history-container[_ngcontent-%COMP%]   .history-list[_ngcontent-%COMP%]   .history-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-last-of-type(1){text-align:right}.history-container[_ngcontent-%COMP%]   .history-list[_ngcontent-%COMP%]   .history-itemHeader[_ngcontent-%COMP%]{font-weight:700;color:#333}.history-container[_ngcontent-%COMP%]   .history-list[_ngcontent-%COMP%]   .history-item[_ngcontent-%COMP%]{margin-bottom:5px;border-bottom:1px solid #ccc;border-top:1px solid #ccc}.history-container[_ngcontent-%COMP%]   .history-list[_ngcontent-%COMP%]   .history-item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0;cursor:pointer}"]})};var E=class o{static isANumberMaybeDecimal=/[0-9]{1,}[\.]{0,1}[0-9]{0,}/g;static decimalIncompleteToTheLeft=/^[0-9]{1,}[\.,]$/;static decimalIncompleteToTheRight=/^[\.,]{1}[0-9]{1,}$/;static isIntroducingADecimalThatEndsInCero=/^[0-9]{0,}[\.\,]{1}[0-9]{0,}[0]{1}$/;static cleanNumberString(t){t=o._normalizeNumberString(t);let e=t.match(o.isANumberMaybeDecimal);if(e==null)return"";let n=o._concatenateStringArray(e);return o.userIsStillIntroducing(n)&&(n=n+"0"),n}static toNumber(t){let e=Number(t);if(isNaN(e)||typeof e!="number")throw new Error("'"+t+"' couldn't be transformed to number");return e}static userIsStillIntroducing(t){return!!(t=="."||t==","||t.match(o.decimalIncompleteToTheLeft)||t.match(o.decimalIncompleteToTheRight)||t.match(o.isIntroducingADecimalThatEndsInCero))}static completeInputIfIsIncomplete(t){return t=o._normalizeNumberString(t),t=="."||t==","?"0.0":t.match(o.decimalIncompleteToTheLeft)?t+"0":t.match(o.decimalIncompleteToTheRight)?"0"+t:t}static _concatenateStringArray(t){let e="";for(let n=0;n<t.length;n++)e=e+t[n];return e}static _normalizeNumberString(t){return t==null?"":(typeof t=="number"&&(t=t+""),t.includes(",")&&(t=t.replaceAll(",",".")),t)}};function _n(o,t){if(o&1){let e=S();l(0,"mwd-history",3),h("recordClick",function(i){m(e);let r=d();return u(r.insertSample(i))})("backFromHistory",function(){m(e);let i=d();return u(i.showHistory$.set(!1))}),c()}}function yn(o,t){if(o&1){let e=S();l(0,"tr",14)(1,"td")(2,"input",15),h("input",function(i){let r=m(e).index,a=d(2);return u(a.updateRow(r,"tamizDiameter",i))})("focusout",function(i){let r=m(e).index,a=d(2);return u(a.checksOnUnfocus(r,"tamizDiameter",i))}),c()(),l(3,"td")(4,"input",16),h("input",function(i){let r=m(e).index,a=d(2);return u(a.updateRow(r,"soilWeight",i))})("focusout",function(i){let r=m(e).index,a=d(2);return u(a.checksOnUnfocus(r,"soilWeight",i))}),c()()()}if(o&2){let e=t.index;b("formGroupName",e)}}function vn(o,t){if(o&1){let e=S();l(0,"div",4)(1,"form",5)(2,"table")(3,"thead")(4,"tr")(5,"th"),f(6,"Di\xE1metro tamiz (mm)"),c(),l(7,"th"),f(8,"Peso de suelo (g)"),c()()(),l(9,"tbody",6),M(10,yn,5,1,"tr",7),c(),l(11,"tfoot")(12,"tr")(13,"td",8)(14,"button",9),h("click",function(){m(e);let i=d();return u(i.removeLastRow())}),f(15,"-"),c(),l(16,"button",9),h("click",function(){m(e);let i=d();return u(i.addRow())}),f(17,"+"),c()()()()()(),l(18,"div",10)(19,"button",9),h("click",function(){m(e);let i=d();return u(i.showHistory$.set(!0))}),f(20,"Historial"),c(),l(21,"input",11,0),h("change",function(i){m(e);let r=d();return u(r.onSelectFile(i))}),c(),l(23,"button",12),h("click",function(){m(e);let i=d();return u(i.onClickReset())}),f(24,"Limpiar"),c(),l(25,"button",9),h("click",function(){m(e);let i=qe(22);return u(i.click())}),f(26,"Insertar csv"),c(),l(27,"button",13),h("click",function(){m(e);let i=d();return u(i.onClickSubmit())}),f(28,"Calcular"),c()()()}if(o&2){let e=d();x(),b("formGroup",e.form),x(9),b("ngForOf",e.rows().controls)}}var ue=class o{formBuilder=w(_t);sampleSubmitted=new W;resetClick=new W;_inDrv=w(R);form=this.formBuilder.group({rows:this.formBuilder.array([])});rows=tt(()=>this.form.get("rows"));displayedColumns=["tamizDiameter","soilWeight"];showHistory$=z(!1);ngAfterViewInit(){this.addRow(),this.addRow()}updateRow(t,e,n){let i=n.target,r=this.rows().at(t),a=i.value;if(E.userIsStillIntroducing(a))return;if(a=E.cleanNumberString(a),i.value!==a){r.patchValue({[e]:a});return}let s=E.toNumber(a);s!==0&&r.patchValue({[e]:s})}checksOnUnfocus(t,e,n){n.stopPropagation(),this._completeInputIfIsIncomplete(t,e,n),this._addCoRowIfPenultimateValueIsCorrect(t)}_addCoRowIfPenultimateValueIsCorrect(t){let e=this.rows().length>1&&this.rows().at(this.rows().length-2).valid,n=t===this.rows().length-1;e&&n&&this.addRow()}_completeInputIfIsIncomplete(t,e,n){let i=n.target,r=this.rows().at(t),a=i.value;E.userIsStillIntroducing(a)&&(a=E.completeInputIfIsIncomplete(a),r.patchValue({[e]:a}))}addRow(){this.rows().push(this._createRowFormGroup())}removeLastRow(){this.rows().removeAt(this.rows().length-1)}_removeRows(){this.rows().clear()}onClickSubmit(){let t=this._castUIToSample();this.sampleSubmitted.emit(t)}_castUIToSample(){let t=new Map;for(let e=0;e<this.rows().controls.length;e++){let i=this.rows().controls[e].value;if(i.soilWeight=Number(E.cleanNumberString(i.soilWeight)),i.tamizDiameter=Number(E.cleanNumberString(i.tamizDiameter)),i.soilWeight==0&&i.tamizDiameter==0){this.removeLastRow();continue}if(typeof i.soilWeight!="number"||isNaN(i.soilWeight))throw new Error("The soilWeight sample '"+i.soilWeight+"' is not a number");if(typeof i.tamizDiameter!="number"||isNaN(i.tamizDiameter))throw new Error("The tamizDiameter sample '"+i.tamizDiameter+"' is not a number");t.set(e,i)}return console.log("introducedSamples",t),t}static numberValidators=[re.required,re.min(0),re.max(100)];_createRowFormGroup(){return this.formBuilder.group({tamizDiameter:new Ce(null,[...o.numberValidators]),soilWeight:new Ce(null,[...o.numberValidators])})}insertSample(t){this.onClickReset(!1),t.forEach(e=>{let n=this.formBuilder.group({tamizDiameter:[e.tamizDiameter,[...o.numberValidators]],soilWeight:[e.soilWeight,o.numberValidators]});this.rows().push(n)}),this.onClickSubmit()}onClickReset(t=!0){this._removeRows(),t&&(this.addRow(),this.addRow()),this.resetClick.emit()}async onSelectFile(t){let e=t.target.files[0],n=await this._inDrv.parseFileToSamples(e);this.insertSample(n)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=O({type:o,selectors:[["app-mwd-samples"]],outputs:{sampleSubmitted:"sampleSubmitted",resetClick:"resetClick"},decls:2,vars:2,consts:[["fileInput",""],[3,"recordClick","backFromHistory",4,"ngIf"],["class","table-container",4,"ngIf"],[3,"recordClick","backFromHistory"],[1,"table-container"],[3,"formGroup"],["formArrayName","rows"],[3,"formGroupName",4,"ngFor","ngForOf"],["colspan","2"],["mat-raised-button","",3,"click"],[1,"button-container"],["hidden","","type","file","accept",".csv",3,"change"],["mat-raised-button","","color","accent",3,"click"],["mat-flat-button","","color","primary",3,"click"],[3,"formGroupName"],["formControlName","tamizDiameter","type","text","inputmode","numeric",3,"input","focusout"],["formControlName","soilWeight","type","text","inputmode","numeric",3,"input","focusout"]],template:function(e,n){e&1&&M(0,_n,1,0,"mwd-history",1)(1,vn,29,2,"div",2),e&2&&(b("ngIf",n.showHistory$()),x(),b("ngIf",n.showHistory$()===!1))},dependencies:[B,ie,oe,mt,ct,dt,pt,ut,gt,ht,ft,U,me],styles:[".table-container[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:hidden;display:flex;justify-content:center;margin-bottom:1rem}@media (width <= 450px){.table-container[_ngcontent-%COMP%]{flex-direction:column}}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:280px;border-collapse:collapse}@media (width < 450px){.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin:0 auto}}@media (width >= 450px){.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{margin-right:1rem}}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ccc;padding:4px 8px;text-align:center}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;appearance:textfield}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-wrap:wrap;background-color:#f5f5f5;font-weight:700}.table-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;column-gap:1rem;row-gap:1rem;flex-wrap:wrap;justify-content:center;gap:8px;margin-top:1rem;justify-content:start}@media (width <= 450px){.table-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{flex-direction:row}}.table-container[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{max-width:200px;margin:0 auto}"]})};var wn=()=>[import("./chunk-TNT5ASPI.js").then(o=>o.MwdResultsComponent)];function bn(o,t){if(o&1){let e=S();l(0,"mwd-results",7),h("downloadClick",function(){m(e);let i=d();return u(i.downloadCsv())}),c()}if(o&2){let e=d();b("results",e.results)}}var he=class o{results=z(null);samples;dialog=w(wt);_ourDrv=w(F);_inDrv=w(R);_historySrv=w(H);onSubmitSample(t){this.samples=t;let e=this._inDrv.resolveSamples(t);this._addToHistory(t,e),this.results.set(e)}_addToHistory(t,e){let n={sample:t,result:e.MWDTotal};this._historySrv.addSamplesRecord(n)}downloadCsv(){let t=this.results();if(!t||!this.samples)throw new Error("Aun no se puede generar csv");this._ourDrv.resultsToCsv(t,this.samples)}async openDialog(){let t=await import("./chunk-C5KCMRVA.js"),e=Object.values(t)[0];this.dialog.open(e).afterClosed().subscribe(i=>{console.log(`Dialog result: ${i}`)})}onResetClick(){this.samples=void 0,this.results.set(null)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=O({type:o,selectors:[["main-layout-root"]],features:[ne([H])],decls:14,vars:0,consts:[[1,"main-header"],[1,"left-header"],["src","/calc_mwd/favicon.ico","alt","AppIcon"],[1,"right-header"],["mat-button","",3,"click"],["id","calc-container"],[3,"sampleSubmitted","resetClick"],[3,"downloadClick","results"]],template:function(e,n){e&1&&(l(0,"header",0)(1,"div",1),N(2,"img",2),l(3,"h3"),f(4,"Calculadora Di\xE1metro Medio Ponderado"),c()(),l(5,"div",3)(6,"button",4),h("click",function(){return n.openDialog()}),f(7,"Ayuda"),c()()(),N(8,"hr"),l(9,"div",5)(10,"app-mwd-samples",6),h("sampleSubmitted",function(r){return n.onSubmitSample(r)})("resetClick",function(){return n.onResetClick()}),c(),M(11,bn,1,1),Ze(12,11,wn),Ye(),c())},dependencies:[B,U,ue],styles:["#calc-container[_ngcontent-%COMP%]{display:flex;column-gap:1rem;margin:1rem 1rem 4rem;justify-content:space-around}.main-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.main-header[_ngcontent-%COMP%]   .left-header[_ngcontent-%COMP%]{display:flex}.main-header[_ngcontent-%COMP%]   .left-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px}.main-header[_ngcontent-%COMP%]   .left-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-left:5px;margin-block-start:0em;margin-block-end:0em}@media (width <= 800px){#calc-container[_ngcontent-%COMP%]{flex-direction:column}}"]})};Tt(he,Pt).catch(o=>console.error(o));
